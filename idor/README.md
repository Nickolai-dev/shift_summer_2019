# уязвимость/атака

## Описание
Атака представляет собой получения логина и пароля, при обращении по URL к файлу, одноимённому логину пользователя, которые представлены на сайте. К логину дописывается .txt и получаем логины и пароли.

Пример уязвимого эндпоинта: http://172.16.53.124:1338/ddawdawd.txt

## Классификация
Если существует какая-то классификация уязвимости/атаки - напишите о ней. Например, могут быть разные техники эксплуатации

## Условия
- ОС: любая
- язык: любой
- компоненты: файлы пользователей
- настройки: разные

## Детектирование
	Детектировать уязвимость возможно:
	- На беке не настроенны роуты
	- Отсутсвует разрешение на просмотр папок 
	- Прямое обращение к файлам в url (0.0.0.0:1338/news.txt)
	- Отсутствие файла .htaccess ( не во всех языках )	
## Эксплуатация
Здесь необходимо описать пример ручной эксплуатации. Сразу уточните какой это язык, какие компоненты используются, если эксплуатация специфична только для этих условий. Можно записать сюда порядок действий при эксплуатации тестового задания
Заходим на сайт: http://172.16.53.124:1338/

В конце сайта смотрим пользователей, берём любой логин и подставляем его http://172.16.53.124:1338/ddawdawd

Теперь добавляем .txt : http://172.16.53.124:1338/ddawdawd.txt . Переходим по ссылки и получаем пароль этого пользователя.

### Инструменты
- [bugcrowd](https://www.bugcrowd.com/blog/how-to-find-idor-insecure-direct-object-reference-vulnerabilities-for-large-bounty-rewards/) - HOW-TO: FIND IDOR (INSECURE DIRECT OBJECT REFERENCE) VULNERABILITIES FOR LARGE BOUNTY REWARDS

## Ущерб
	- Полечение логина и пароля любого пользователя
	- Возможность обращяться к любым файлам в системе ( к которым есть доступ )	
## Защита
### Основные меры
Для файлов содержащие логин и пароль создать отдельную папку к которой будет запрещен доступ с внешних устройств, так же настроить роутинг на запреь к данной директории. 

### Превентивные меры
подход Defense in Depth:
- хранить хэш паролей + соль для того, что бы злоумышленник не мог получить доступ к паролю напрямую

## Дополнительно
	http://software-testing.ru/library/testing/security/2991-testing-for-idor-vulnerabilitie
